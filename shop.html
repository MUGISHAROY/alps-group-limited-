<!DOCTYPE html>
<html lang="en" x-data="shopSystem()" :class="darkMode ? 'dark' : ''">
<head>
    <meta charset="UTF-8">
    <title>Alps Group | Official Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .dark { background-color: #121212; color: #e5e5e5; }
        .dark .card { background-color: #1e1e1e; border-color: #333; }
        /* Accessibility: High Contrast Focus */
        :focus { outline: 3px solid #d97706; outline-offset: 2px; }
    </style>
</head>
<body class="transition-colors duration-500 font-sans">

    <nav class="p-6 border-b flex justify-between items-center bg-white dark:bg-stone-900 sticky top-0 z-50">
        <h1 class="text-2xl font-black text-amber-900 dark:text-amber-500">ALPS <span class="text-stone-800 dark:text-white">GROUP</span></h1>
        
        <div class="flex items-center gap-6">
            <button @click="darkMode = !darkMode" class="p-2 rounded-lg bg-gray-100 dark:bg-stone-800" aria-label="Toggle Dark Mode">
                <i class="fas" :class="darkMode ? 'fa-sun text-yellow-400' : 'fa-moon text-stone-600'"></i>
            </button>
            <button @click="increaseFont()" class="hidden md:block text-sm font-bold border px-2 rounded">A+</button>
        </div>
    </nav>

    <div class="container mx-auto px-6 py-10">
        <div class="flex flex-col md:flex-row gap-10">
            
            <aside class="w-full md:w-64 space-y-4">
                <h3 class="font-bold text-xl mb-6">Categories</h3>
                <template x-for="cat in categories">
                    <button 
                        @click="activeCat = cat"
                        class="w-full text-left p-4 rounded-xl transition-all border-l-4"
                        :class="activeCat === cat ? 'bg-amber-50 border-amber-600 text-amber-900 font-bold' : 'border-transparent hover:bg-gray-50'"
                        x-text="cat">
                    </button>
                </template>
            </aside>

            <main class="flex-1">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <template x-for="product in filteredProducts" :key="product.id">
                        <div class="card bg-white p-4 rounded-[2rem] shadow-sm border border-stone-100 hover:shadow-2xl transition-all group">
                            <div class="relative overflow-hidden rounded-[1.5rem]">
                                <img :src="product.image" class="h-60 w-full object-cover group-hover:scale-110 transition duration-500">
                                <span class="absolute top-4 left-4 bg-black/60 backdrop-blur text-white text-[10px] px-3 py-1 rounded-full" x-text="product.category"></span>
                            </div>
                            <div class="pt-6 px-2">
                                <h4 class="text-xl font-bold mb-1" x-text="product.name"></h4>
                                <p class="text-amber-600 font-black text-lg mb-4">UGX <span x-text="product.price.toLocaleString()"></span></p>
                                <button @click="contactWhatsApp(product)" class="w-full bg-stone-900 dark:bg-amber-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-2">
                                    <i class="fab fa-whatsapp"></i> Order Now
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </main>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { /* YOUR CONFIG HERE */ };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.shopSystem = () => {
            return {
                darkMode: false,
                activeCat: 'All Materials',
                categories: ['All Materials', 'Cement', 'Sand/Aggregates', 'Bricks/Blocks', 'Steel/Timber'],
                products: [],
                
                init() {
                    onSnapshot(collection(db, "products"), (snap) => {
                        this.products = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    });
                },

                get filteredProducts() {
                    if (this.activeCat === 'All Materials') return this.products;
                    return this.products.filter(p => p.category === this.activeCat);
                },

                contactWhatsApp(p) {
                    const msg = encodeURIComponent(`Hello Alps Group, I'm interested in ${p.name} (${p.category}) priced at UGX ${p.price}.`);
                    window.open(`https://wa.me/256775065744?text=${msg}`);
                }
            }
        }
    </script>
</body>
</html>