<!DOCTYPE html>
<html lang="en" x-data="shopSystem()" :class="darkMode ? 'dark' : ''">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alps Group Ltd | Construction Materials Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        [x-cloak] { display: none !important; }
        .dark { background-color: #121212; color: #e5e5e5; }
        .ugandan-pattern { background-image: url("https://www.transparenttextures.com/patterns/natural-paper.png"); }
        .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    </style>
</head>
<body class="ugandan-pattern transition-colors duration-500 min-h-screen">

    <nav class="sticky top-0 z-50 bg-white/80 dark:bg-stone-900/80 backdrop-blur-md border-b dark:border-stone-800 p-4">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="text-2xl font-black text-amber-900 dark:text-amber-500 tracking-tighter">
                ALPS GROUP <span class="text-stone-800 dark:text-white">LTD</span>
            </a>
            <div class="flex items-center gap-4">
                <button @click="darkMode = !darkMode" class="p-2 rounded-full bg-stone-100 dark:bg-stone-800 text-stone-600 dark:text-amber-400 shadow-inner">
                    <i class="fas" :class="darkMode ? 'fa-sun' : 'fa-moon'"></i>
                </button>
                <a href="index.html" class="text-sm font-bold uppercase tracking-widest hover:text-amber-600 transition">Home</a>
            </div>
        </div>
    </nav>

    <header class="py-12 text-center container mx-auto px-6">
        <h2 class="text-4xl md:text-5xl font-black text-stone-900 dark:text-white mb-4">Material Inventory</h2>
        <p class="text-stone-500 dark:text-stone-400 italic">Premium Ugandan construction materials, delivered to your site.</p>
    </header>

    <div class="container mx-auto px-6 pb-20">
        <div class="flex flex-col md:flex-row gap-8">
            
            <aside class="w-full md:w-64 space-y-2">
                <h3 class="text-xs font-black uppercase tracking-[0.2em] text-amber-700 mb-4 px-4">Categories</h3>
                <template x-for="cat in categories">
                    <button @click="activeCat = cat" 
                            class="w-full text-left px-5 py-3 rounded-2xl font-bold transition-all text-sm flex justify-between items-center"
                            :class="activeCat === cat ? 'bg-amber-600 text-white shadow-lg scale-105' : 'bg-white dark:bg-stone-800 text-stone-600 dark:text-stone-400 hover:bg-amber-50 dark:hover:bg-stone-700'">
                        <span x-text="cat"></span>
                        <i class="fas fa-chevron-right text-[10px]" x-show="activeCat === cat"></i>
                    </button>
                </template>
            </aside>

            <main class="flex-1">
                <div x-show="loading" class="flex flex-col items-center justify-center py-20">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600"></div>
                    <p class="mt-4 font-bold text-stone-400">Fetching Materials...</p>
                </div>

                <div x-show="!loading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" x-cloak>
                    <template x-for="product in filteredProducts" :key="product.id">
                        <div class="product-card bg-white dark:bg-stone-800 rounded-[2.5rem] overflow-hidden shadow-sm hover:shadow-2xl border border-stone-100 dark:border-stone-700 group">
                            <div class="h-64 overflow-hidden relative">
                                <img :src="product.image" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                                <div class="absolute top-4 right-4 bg-white/90 dark:bg-stone-900/90 backdrop-blur px-3 py-1 rounded-full text-[10px] font-black text-amber-800 dark:text-amber-500 uppercase tracking-widest shadow-sm" x-text="product.category"></div>
                            </div>
                            <div class="p-8">
                                <h4 class="text-2xl font-bold text-stone-900 dark:text-white mb-2" x-text="product.name"></h4>
                                <div class="flex justify-between items-end mb-6">
                                    <div>
                                        <p class="text-[10px] font-black text-stone-400 uppercase tracking-widest">Price per Unit</p>
                                        <p class="text-xl font-black text-amber-700 dark:text-amber-500">UGX <span x-text="Number(product.price).toLocaleString()"></span></p>
                                    </div>
                                    <div class="text-right">
                                        <i class="fas fa-shield-alt text-emerald-500"></i>
                                        <p class="text-[8px] font-bold text-emerald-600 uppercase">Verified Quality</p>
                                    </div>
                                </div>
                                <button @click="openWhatsApp(product)" class="w-full bg-stone-900 dark:bg-amber-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 hover:bg-amber-700 dark:hover:bg-amber-500 transition-colors shadow-lg shadow-amber-900/10">
                                    <i class="fab fa-whatsapp text-xl"></i> Order on WhatsApp
                                </button>
                            </div>
                        </div>
                    </template>
                </div>

                <div x-show="!loading && filteredProducts.length === 0" class="text-center py-20 bg-white dark:bg-stone-800 rounded-[3rem] border-2 border-dashed border-stone-200 dark:border-stone-700">
                    <i class="fas fa-box-open text-5xl text-stone-300 mb-4"></i>
                    <p class="text-stone-500 font-bold italic">No materials found in this category yet.</p>
                </div>
            </main>
        </div>
    </div>

    <footer class="py-12 text-center border-t dark:border-stone-800 mt-10">
        <p class="text-xs font-black text-stone-400 uppercase tracking-[0.3em] mb-4">Alps Group Limited • Kampala, Uganda</p>
        <p class="text-xs text-stone-500 italic">Built by <span class="text-stone-900 dark:text-white font-bold not-italic">Mugisha Roy</span> — Apex Ventures Uganda</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // YOUR ALPS GROUP CONFIGURATION
        const firebaseConfig = {
            apiKey: "AIzaSyBUm3H66Hw2bmpO8PmSHWLAOM0o5shw_oM",
            authDomain: "alps-group-limited.firebaseapp.com",
            projectId: "alps-group-limited",
            storageBucket: "alps-group-limited.firebasestorage.app",
            messagingSenderId: "416661528150",
            appId: "1:416661528150:web:1ffbdab87267c37b9165f7",
            measurementId: "G-D52H04VL5Q"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.shopSystem = () => {
            return {
                darkMode: false,
                loading: true,
                activeCat: 'All Materials',
                categories: ['All Materials', 'Cement', 'Sand/Aggregates', 'Bricks/Blocks', 'Steel/Timber'],
                products: [],

                init() {
                    // Listen to Firestore real-time
                    const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
                    onSnapshot(q, (snapshot) => {
                        this.products = snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        }));
                        this.loading = false;
                    });
                },

                get filteredProducts() {
                    if (this.activeCat === 'All Materials') return this.products;
                    return this.products.filter(p => p.category === this.activeCat);
                },

                openWhatsApp(p) {
                    const text = `*ALPS GROUP - NEW ORDER*%0A--------------------------%0A*Product:* ${p.name}%0A*Category:* ${p.category}%0A*Price:* UGX ${p.price.toLocaleString()}%0A--------------------------%0A_Please confirm availability and delivery for this material._`;
                    window.open(`https://wa.me/256700000000?text=${text}`, '_blank');
                }
            }
        }
    </script>
</body>
</html>